<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Thiệp 20/10</title>
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Quicksand:wght@400;700&display=swap" rel="stylesheet">
  <style>
    html,body{height:100%;margin:0}
    body{font-family:'Quicksand',sans-serif;display:flex;align-items:center;justify-content:center;
      /* mystical deep background to match greeting */
      background: radial-gradient(ellipse at top left, #3b0b3b 0%, #160018 35%, #07000a 100%);
      color: #ffdfee;
    }
    .card{max-width:820px;width:94%;background:linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));border-radius:18px;padding:40px;box-shadow:0 20px 60px rgba(0,0,0,0.35);text-align:center;position:relative;overflow:visible;backdrop-filter: blur(6px) saturate(120%)}
    h1{font-family:'Pacifico',cursive;color:#ffd1e8;margin:0 0 8px;font-size:48px;text-shadow:0 8px 28px rgba(200,80,200,0.12)}
    p.lead{color:rgba(255,255,255,0.9);font-size:20px;margin:0 0 18px}
    p.body{color:rgba(255,255,255,0.92);max-width:680px;margin:0 auto 10px;line-height:1.6}
    .big-img{width:240px;height:240px;border-radius:18px;display:block;margin:18px auto 6px;background:transparent;padding:0;border:0;box-shadow:none}
  /* heart animations */
  .heart-center{position:absolute;left:50%;top:46%;transform:translate(-50%,-50%);width:320px;height:320px;pointer-events:none;z-index:6;opacity:1}
  .heart-center svg{width:100%;height:100%}
  .heart-beating{animation:beat 0.82s ease-out}
  @keyframes beat{0%{transform:translate(-50%,-50%) scale(1)}30%{transform:translate(-50%,-50%) scale(1.14)}45%{transform:translate(-50%,-50%) scale(0.98)}100%{transform:translate(-50%,-50%) scale(1)}}
  .floating-heart{position:fixed;width:28px;height:28px;pointer-events:none;z-index:9;opacity:0.95;filter:drop-shadow(0 8px 20px rgba(0,0,0,0.45));animation:floatUp linear forwards}
  @keyframes floatUp{to{transform:translateY(-120vh) scale(1.1);opacity:0}}
    footer{color:#b983ff;margin-top:14px;opacity:0.9}
    /* petals */
    .petal{position:fixed;top:-60px;width:28px;height:28px;pointer-events:none;z-index:10;opacity:.9;filter:drop-shadow(0 8px 20px rgba(0,0,0,0.45));animation:fall linear forwards}
    @keyframes fall{to{transform:translateY(110vh) rotate(360deg);opacity:0.7}}
  </style>
</head>
<body>
  <div class="card">
    <h1>Chúc mừng em yêu 20/10 vui vẻ</h1>
  <!-- optional image removed for a cleaner mystical card; keep space for heart SVG -->
  <div class="big-img" aria-hidden="true"></div>
    <p class="lead">Hôm nay là ngày 20/10 một ngày đặt biệt dành cho những người con gái đặc biệt</p>
    <p class="body">Em là một trong những người con gái đặc biệt nhất trong cuộc đời anh. Chúc em luôn xinh đẹp, hạnh phúc và thành công trong mọi lĩnh vực của cuộc sống. Anh rất may mắn khi có em bên cạnh.</p>
    <footer>&mdash; Anh Yêu &mdash;</footer>
  </div>
  <div class="heart-center" style="pointer-events:auto;"> 
    <canvas id="heartDotCanvas" width="520" height="520" style="width:320px;height:320px;display:block;margin:auto;pointer-events:auto;border-radius:50%;"></canvas>
  </div>
  <script>
    const petalSVG = `<svg width="28" height="28" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><ellipse cx="16" cy="20" rx="8" ry="12" fill="#ffd1dc"/><ellipse cx="16" cy="12" rx="6" ry="8" fill="#ffb7ef"/></svg>`;
    function createPetal(){
      const petal=document.createElement('div');petal.className='petal';petal.innerHTML=petalSVG;petal.style.left=Math.random()*100+'vw';petal.style.animationDuration=(6+Math.random()*4)+'s';petal.style.transform=`rotate(${Math.random()*360}deg)`;document.body.appendChild(petal);setTimeout(()=>petal.remove(),11000);
    }
    setInterval(createPetal,600);for(let i=0;i<6;i++)setTimeout(createPetal,i*300);

    // floating hearts (kept for ambience)
    function createHeart(){
      const heart=document.createElement('div');heart.className='floating-heart';
      const hue = Math.floor(320+Math.random()*30);
      heart.style.left = (10+Math.random()*80)+'vw';
      heart.style.top = (60+Math.random()*30)+'vh';
       heart.style.animationDuration = (10+Math.random()*8)+'s';
      heart.innerHTML = `<svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M256 448s192-112 192-240C448 120 368 48 256 144 144 48 64 120 64 208c0 128 192 240 192 240z" fill="hsl(${hue},85%,70%)"/></svg>`;
      document.body.appendChild(heart);
      setTimeout(()=>heart.remove(),12000);
    }
    const heartInterval = setInterval(createHeart,900);

    // ---- particle-dots heart ----
    (function(){
      const canvas = document.getElementById('heartDotCanvas');
      const ctx = canvas.getContext('2d');
      const dpr = Math.min(window.devicePixelRatio||1,2);
      function resize(){
        const rect = canvas.getBoundingClientRect();
        canvas.width = Math.round(rect.width * dpr);
        canvas.height = Math.round(rect.height * dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0);
      }
      // ensure canvas size matches style
      resize(); window.addEventListener('resize', resize);

      // generate target points along a heart path
      function pointOnHeart(t, scale){
        const x = 16 * Math.pow(Math.sin(t),3);
        const y = 13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t);
        return {x: x*scale, y: -y*scale};
      }

      // sample many points inside the heart area by rejection sampling (simple and small)
      function generateTargets(count, w, h){
        const targets = [];
        const scale = Math.min(w,h)/40; // tune
        // create contour points first
        for(let i=0;i<count;i++){
          const t = -Math.PI + Math.random()*2*Math.PI;
          const p = pointOnHeart(t, scale);
          // jitter near contour inward
          targets.push({x: w/2 + p.x + (Math.random()-0.5)*scale*0.6, y: h/2 + p.y + (Math.random()-0.5)*scale*0.6});
        }
        return targets;
      }

      // particle class (with alpha for fade-in)
      class Dot { 
        constructor(x,y){ 
          this.x=x; this.y=y; this.tx=x; this.ty=y; this.vx=0; this.vy=0; 
          this.r=1.2 + Math.random()*1.8; 
          this.col = `rgba(255,${140+Math.floor(Math.random()*80)},${180+Math.floor(Math.random()*40)},1)`;
          this.alpha = 0; // fade in
        }
      }

      let dots = [];
      let dotsStartTime = performance.now();
      function initDots(){
        dotsStartTime = performance.now();
        const rect = canvas.getBoundingClientRect();
        const w = rect.width; const h = rect.height;
        const cx = w/2; const cy = h/2;
        const maxDim = Math.max(w,h);
        const targets = generateTargets(420, w, h);
        // create dots starting outside canvas bounds and give them an initial inward velocity
        dots = targets.map(t => {
          // pick a random angle and radius outside the canvas
          const angle = Math.random()*Math.PI*2;
          const radius = maxDim*0.6 + Math.random()*maxDim*1.0; // start well outside
          const sx = cx + Math.cos(angle)*radius;
          const sy = cy + Math.sin(angle)*radius;
          const d = new Dot(sx, sy);
          d.tx = t.x; d.ty = t.y;
          // initial inward velocity so dots 'run in' toward targets
          const dx = d.tx - d.x; const dy = d.ty - d.y; const dist = Math.sqrt(dx*dx+dy*dy) + 0.0001;
          const speedFactor = 0.018 * (0.8 + Math.random()*1.2); // tune for gentle entry
          d.vx = dx/dist * dist * speedFactor;
          d.vy = dy/dist * dist * speedFactor;
          // slight color variation toward cooler tone occasionally
          if(Math.random() < 0.15) d.col = `rgba(${220+Math.floor(Math.random()*20)},${120+Math.floor(Math.random()*30)},${200+Math.floor(Math.random()*30)},1)`;
          return d;
        });
      }
      initDots();

      // animate dots toward targets with springy motion (slower/gentler)
      let last = performance.now();
      function tick(){
        const now = performance.now(); const dt = Math.min(0.04, (now-last)/1000); last=now;
        ctx.clearRect(0,0,canvas.width,canvas.height);
        for(const d of dots){
          // spring toward target (weakened spring for smoother motion)
          const dx = d.tx - d.x; const dy = d.ty - d.y;
          d.vx += dx * 2.2 * dt; d.vy += dy * 2.2 * dt; // slightly reduced
          // damping
          d.vx *= 0.93; d.vy *= 0.93;
          // positional update
          d.x += d.vx * dt * 40; d.y += d.vy * dt * 40;
          // fade in alpha over first ~800ms
          const sinceStart = (performance.now() - dotsStartTime);
          d.alpha = Math.min(1, d.alpha + dt * 1.6);
          // draw with alpha
          ctx.beginPath(); ctx.fillStyle = d.col; ctx.globalAlpha = 0.85 * d.alpha; ctx.arc(d.x, d.y, d.r, 0, Math.PI*2); ctx.fill(); ctx.globalAlpha = 1;
        }
        requestAnimationFrame(tick);
      }
      tick();

      // beat effect: push dots outward briefly and then return
      function beatPush(){
        for(const d of dots){
          // apply gentle outward impulse from center
          const cx = canvas.getBoundingClientRect().width/2; const cy = canvas.getBoundingClientRect().height/2;
          const ux = d.x - cx; const uy = d.y - cy; const dist = Math.sqrt(ux*ux+uy*uy) + 0.0001;
          const nx = ux/dist; const ny = uy/dist;
          const force = 2 + Math.random()*1.5; // gentler force
          d.vx += nx * force; d.vy += ny * force;
        }
      }

      // trigger beat on a slower interval
      setInterval(()=>{ beatPush(); }, 1200);

      // on click play a beat and spawn floating hearts
      const card = document.querySelector('.card');
  card.addEventListener('click', ()=>{ beatPush(); for(let i=0;i<6;i++) createHeart(); });

      // re-generate targets on resize
      let resizeTimeout;
      window.addEventListener('resize', ()=>{ clearTimeout(resizeTimeout); resizeTimeout = setTimeout(()=>{ resize(); initDots(); }, 200); });
    })();
  </script>
</body>
</html>
